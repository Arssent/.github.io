<html>
   <head>
    <link rel="stylesheet" type="text/css" href="style.css"/>
     <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
     <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.0/aframe/build/aframe-ar.js"></script>
  
<script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
<style>   
      a-scene {
        height: 300px;
        width: 50%;
      }
</style>
</head>
  <body style='margin : 0px; overflow: hidden;'>
<button  disabled="true">Please wait, loading...</button>
<script>
   alert('goo7');

var WIDTH = 640;
var HEIGHT = 360;

// Interesting parameters to tweak!
var SMOOTHING = 0.8;
var FFT_SIZE = 2048;

function VisualizerSample() {
  this.analyser = context.createAnalyser();

  this.analyser.connect(context.destination);
  this.analyser.minDecibels = -140;
  this.analyser.maxDecibels = 0;
  loadSounds(this, {
    buffer: 'A Thousand Thousandths.mp3'
  }, onLoaded);
  this.freqs = new Uint8Array(this.analyser.frequencyBinCount);
  this.times = new Uint8Array(this.analyser.frequencyBinCount);

  function onLoaded() {
    var button = document.querySelector('button');
    button.removeAttribute('disabled');
    button.innerHTML = 'Play/pause';
  };

  this.isPlaying = false;
  this.startTime = 0;
  this.startOffset = 0;
}

// Toggle playback
VisualizerSample.prototype.togglePlayback = function() {
  if (this.isPlaying) {
    // Stop playback
    this.source[this.source.stop ? 'stop': 'noteOff'](0);
    this.startOffset += context.currentTime - this.startTime;
    console.log('paused at', this.startOffset);
    // Save the position of the play head.
  } else {
    this.startTime = context.currentTime;
    console.log('started at', this.startOffset);
    this.source = context.createBufferSource();
    // Connect graph
    this.source.connect(this.analyser);
    this.source.buffer = this.buffer;
    this.source.loop = true;
    // Start playback, but make sure we stay in bound of the buffer.
    this.source[this.source.start ? 'start' : 'noteOn'](0, this.startOffset % this.buffer.duration);
    // Start visualizer.
    requestAnimFrame(this.draw.bind(this));
  }
  this.isPlaying = !this.isPlaying;
}


VisualizerSample.prototype.draw = function() {
  this.analyser.smoothingTimeConstant = SMOOTHING;
  this.analyser.fftSize = FFT_SIZE;

  // Get the frequency data from the currently playing music
  this.analyser.getByteFrequencyData(this.freqs);
  this.analyser.getByteTimeDomainData(this.times);

  var width = Math.floor(1/this.freqs.length, 10);


  // Draw the frequency domain chart.
 
    var value = this.freqs;
    var percent = value / 256;
 
                //this.BoXx=document.querySelector('#test3');
              // this.Likvid=document.querySelector('#test1');
                
               this.Text1=document.querySelector('#test1');
               this.Text2=document.querySelector('#test2');
               this.Text3=document.querySelector('#test3');
               this.Text4=document.querySelector('#test4');
               this.Text5=document.querySelector('#test5');
             this.Text6=document.querySelector('#test6');
             this.Text7=document.querySelector('#test7');
               this.Text8=document.querySelector('#test8');
              
	     var channels= [];
              var X=0;
              var max;
               var m;
               var i;
               var g;
               var ch1;
               var ch2;
               var ch3;
               var ch4;
               var ch5;
               var ch6;
               var ch7;
               var ch8;
               var ch9;
               
               var X1=0.037;
               var Y1=0.02;
               var Z1=0.04;    
               var X2=0.04;
               var Y2=0.04;
               var Z2=0.04;
               var X3=0.04;
               var Y3=0.04;
               var Z3=0.04; 
               var X4=0.04;
               var Y4=0.04;
               var Z4=0.04; 
               var X5=0.04;
               var Y5=0.04;
               var Z5=0.04;
               var X6=0.121;
               var Y6=0.1;
               var Z6=0.1; 
               var X7=0.121;
               var Y7=0.1;
               var Z7=0.1; 
               var X8=0.121;
               var Y8=0.1;
               var Z8=0.1;               
                   
                
             
            
             
  for(m=0; m<9; m++){
  
       for(i=0; i<24; i++){
          g=X+i;
      // X=++
       if(i==0){
        max=this.freqs[g];
        max =max / 256;
	 
        max=Math.exp(max) || 1;
          
            };
          
          if(max<this.freqs[g]){
             max=this.freqs[g];
             max =max / 256;
	    // max =max * 0.1;
             max=Math.exp(max) || 1;
          // max=Math.exp((this.pulse[X]) / 456) || 1;
              };
       };
    // max= max-1;
   // max =max * 10;
     channels[m]=max;
     X+=10;
};
	  
if(channels[0]>channels[1] && channels[0]>channels[1] && channels[0]>channels[2] && channels[0]>channels[3] && channels[0]>channels[4] && channels[0]>channels[5] && channels[0]>channels[7] && channels[0]>channels[8]){
ch1=channels[0];  ch2=channels[1]; ch3=channels[2]; ch4=channels[3]; ch5=channels[4]; ch6=channels[5]; ch7=channels[6]; ch8=channels[7]; ch9=channels[8];
X1=X1*ch1; Y1=Y1*ch1; Z1=Z1*ch1;
X2=X2 / ch2;  Y2=Y2 / ch2;  Z2=Z2 / ch2;    
X3=X3 / ch3;  Y3=Y3 / ch3;    Z3=Z3 / ch3; 
X4=X4 / ch4;  Y4=Y4 / ch4;  Z4=Z4 / ch4;    
X5=X5 / ch5;  Y5=Y5 / ch5;  Z5=Z5 / ch5;  
X6=X6 / ch6;  Y6=Y6 / ch6;  Z6=Z6 / ch6;  
X7=X7 / ch7;  Y7=Y7 / ch7;  Z7=Z7 / ch7;  
X8=X8 / ch8;  Y8=Y8 / ch8;  Z8=Z8 / ch8;  
    
console.log(X1+' '+X2+' '+X3+' '+X4+' '+X5+' '+X6+' '+X7+' '+X8+' ');
this.Text1.setAttribute('scale', {x: X1, y: Y1, z: 0.04});
this.Text2.setAttribute('scale', {x: X2, y: Y2, z: 0.04});
this.Text3.setAttribute('scale', {x: X3, y: Y3, z: 0.04});
this.Text4.setAttribute('scale', {x: X3, y: Y4, z: 0.04});
this.Text5.setAttribute('scale', {x: X4, y: Y5, z: 0.04});

//console.log('go');
   //alert(this.Text1);
}else if(channels[1]>channels[0] && channels[1]>channels[2] && channels[1]>channels[3] && channels[1]>channels[4] && channels[1]>channels[5] && channels[1]>channels[6] && channels[1]>channels[7] && channels[1]>channels[8]){
ch1=channels[0];  ch2=channels[1]; ch3=channels[2]; ch4=channels[3]; ch5=channels[4]; ch6=channels[5]; ch7=channels[6]; ch8=channels[7]; ch9=channels[8];
X1=X1 / ch1; Y1=Y1 / ch1; Z1=Z1 / ch1;
X2=X2*ch2; Y2=Y2*ch2; Z2=Z2*ch2;     
X3=X3 / ch3; Y3=Y3 / ch3; Z3=Z3 / ch3;
X4=X4 / ch4; Y4=Y4 / ch4; Z4=Z4 / ch4;   
X5=X5 / ch5; Y5=Y5 / ch5; Z5=Z5 / ch5;  
X6=X6 / ch6; Y6=Y6 / ch6; Z6=Z6 / ch6;
X7=X7 / ch7; Y7=Y7 / ch7; Z7=Z7 / ch7;
X8=X8 / ch8; Y8=Y8 / ch8; Z8=Z8 / ch8;
   
this.Text1.setAttribute('scale', {x: X1, y: Y1, z: 0.04});
this.Text2.setAttribute('scale', {x: X2, y: Y2, z: 0.04});
this.Text3.setAttribute('scale', {x: X3, y: Y3, z: 0.04});
this.Text4.setAttribute('scale', {x: X3, y: Y4, z: 0.04});
this.Text5.setAttribute('scale', {x: X4, y: Y5, z: 0.04});

  
} else if(channels[2]>channels[0] && channels[2]>channels[1] && channels[2]>channels[3] && channels[2]>channels[4] && channels[2]>channels[5] && channels[2]>channels[6] && channels[2]>channels[7] && channels[2]>channels[8]){
ch1=channels[0];  ch2=channels[1]; ch3=channels[2]; ch4=channels[3]; ch5=channels[4]; ch6=channels[5]; ch7=channels[6]; ch8=channels[7]; ch9=channels[8];
 
X1=X1 / ch1; Y1=Y1 / ch1; Z1=Z1 / ch1;
X2=X2 / ch2; Y2=Y2 / ch2; Z2=Z2 / ch2;     
X3=X3*ch3; Y3=Y3*ch3; Z3=Z3*ch3;
X4=X4 / ch4; Y4=Y4 / ch4; Z4=Z4 / ch4;   
X5=X5 / ch5; Y5=Y5 / ch5; Z5=Z5 / ch5;  
X6=X6 / ch6; Y6=Y6 / ch6; Z6=Z6 / ch6;
X7=X7 / ch7; Y7=Y7 / ch7; Z7=Z7 / ch7;
X8=X8 / ch8; Y8=Y8 / ch8; Z8=Z8 / ch8;
   
this.Text1.setAttribute('scale', {x: X1, y: Y1, z: 0.04});
this.Text2.setAttribute('scale', {x: X2, y: Y2, z: 0.04});
this.Text3.setAttribute('scale', {x: X3, y: Y3, z: 0.04});
this.Text4.setAttribute('scale', {x: X3, y: Y4, z: 0.04});
this.Text5.setAttribute('scale', {x: X4, y: Y5, z: 0.04});

  
} else if(channels[3]>channels[0] && channels[3]>channels[1]  && channels[3]>channels[2] && channels[3]>channels[4] && channels[3]>channels[5] && channels[3]>channels[6] &&  channels[3]>channels[7] && channels[3]>channels[8]){
ch1=channels[0];  ch2=channels[1]; ch3=channels[2]; ch4=channels[3]; ch5=channels[4]; ch6=channels[5]; ch7=channels[6]; ch8=channels[7]; ch9=channels[8];
  
X1=X1 / ch1; Y1=Y1 / ch1; Z1=Z1 / ch1;
X2=X2 / ch2; Y2=Y2 / ch2; Z2=Z2 / ch2;     
X3=X3 / ch3; Y3=Y3 / ch3; Z3=Z3 / ch3;
X4=X4*ch4; Y4=Y4*ch4; Z4=Z4*ch4;   
X5=X5 / ch5; Y5=Y5 / ch5; Z5=Z5 / ch5;  
X6=X6 / ch6; Y6=Y6 / ch6; Z6=Z6 / ch6;
X7=X7 / ch7; Y7=Y7 / ch7; Z7=Z7 / ch7;
X8=X8 / ch8; Y8=Y8 / ch8; Z8=Z8 / ch8; 
   
this.Text1.setAttribute('scale', {x: X1, y: Y1, z: 0.04});
this.Text2.setAttribute('scale', {x: X2, y: Y2, z: 0.04});
this.Text3.setAttribute('scale', {x: X3, y: Y3, z: 0.04});
this.Text4.setAttribute('scale', {x: X3, y: Y4, z: 0.04});
this.Text5.setAttribute('scale', {x: X4, y: Y5, z: 0.04});

   
} else if(channels[4]>channels[0] && channels[4]>channels[1] && channels[4]>channels[2] && channels[4]>channels[3] && channels[4]>channels[5] &&channels[4]>channels[6] &&  channels[4]>channels[7] && channels[4]>channels[8]){
ch1=channels[0];  ch2=channels[1]; ch3=channels[2]; ch4=channels[3]; ch5=channels[4]; ch6=channels[5]; ch7=channels[6]; ch8=channels[7]; ch9=channels[8];
    
X1=X1 / ch1; Y1=Y1 / ch1; Z1=Z1 / ch1;
X2=X2 / ch2; Y2=Y2 / ch2; Z2=Z2 / ch2;     
X3=X3 / ch3; Y3=Y3 / ch3; Z3=Z3 / ch3;
X4=X4 / ch4; Y4=Y4 / ch4; Z4=Z4 / ch4;   
X5=X5*ch5; Y5=Y5*ch5; Z5=Z5*ch5;  
X6=X6 / ch6; Y6=Y6 / ch6; Z6=Z6 / ch6;
X7=X7 / ch7; Y7=Y7 / ch7; Z7=Z7 / ch7;
X8=X8 / ch8; Y8=Y8 / ch8; Z8=Z8 / ch8; 
   
this.Text1.setAttribute('scale', {x: X1, y: Y1, z: 0.04});
this.Text2.setAttribute('scale', {x: X2, y: Y2, z: 0.04});
this.Text3.setAttribute('scale', {x: X3, y: Y3, z: 0.04});
this.Text4.setAttribute('scale', {x: X3, y: Y4, z: 0.04});
this.Text5.setAttribute('scale', {x: X4, y: Y5, z: 0.04});

   
}else if(channels[5]>channels[0] && channels[5]>channels[1]  && channels[5]>channels[2] && channels[5]>channels[3] && channels[5]>channels[4]  && channels[5]>channels[6] &&  channels[5]>channels[7] && channels[5]>channels[8]){
ch1=channels[0];  ch2=channels[1]; ch3=channels[2]; ch4=channels[3]; ch5=channels[4]; ch6=channels[5]; ch7=channels[6]; ch8=channels[7]; ch9=channels[8];
   
X1=X1 / ch1; Y1=Y1 / ch1; Z1=Z1 / ch1;
X2=X2 / ch2; Y2=Y2 / ch2; Z2=Z2 / ch2;     
X3=X3 / ch3; Y3=Y3 / ch3; Z3=Z3 / ch3;
X4=X4 / ch4; Y4=Y4 / ch4; Z4=Z4 / ch4;   
X5=X5 / ch5; Y5=Y5 / ch5; Z5=Z5 / ch5;  
X6=X6*ch6; Y6=Y6*ch6; Z6=Z6*ch6;
X7=X7 / ch7; Y7=Y7 / ch7; Z7=Z7 / ch7;
X8=X8 / ch8; Y8=Y8 / ch8; Z8=Z8 / ch8;
this.Text1.setAttribute('scale', {x: X1, y: Y1, z: 0.04});
this.Text2.setAttribute('scale', {x: X2, y: Y2, z: 0.04});
this.Text3.setAttribute('scale', {x: X3, y: Y3, z: 0.04});
this.Text4.setAttribute('scale', {x: X3, y: Y4, z: 0.04});
this.Text5.setAttribute('scale', {x: X4, y: Y5, z: 0.04});

}
	  console.log("& "+ch1+"& "+ch2+"& "+ch3+"& "+ch4+"& "+ch5+"& "+ch6+"& "+ch7+"& "+ch8+"& "+ch9);

	  
 


  if (this.isPlaying) {
    requestAnimFrame(this.draw.bind(this));
  }
}

VisualizerSample.prototype.getFrequencyValue = function(freq) {
  var nyquist = context.sampleRate/2;
  var index = Math.round(freq/nyquist * this.freqs.length);
  return this.freqs[index];
}
	
	
	
	
	



</script>
	
    
<div class="poster" >
<a-scene embedded arjs='sourceType: webcam;' >
  <a-assets>
 <a-asset-item id="MainModel" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%B4%D0%BB%D1%8F%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20motel2.obj"></a-asset-item>
  <a-asset-item id="tesst1" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%B4%D0%BB%D1%8F%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20motel2.obj"></a-asset-item>
   <a-asset-item id="tesst2" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%B4%D0%BB%D1%8F%20%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82%D0%B0%2020%2000%20fin.obj"></a-asset-item>
       <a-asset-item id="tesst3" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%B4%D0%BB%D1%8F%20%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82%D0%B0%2011%20final.obj"></a-asset-item>
           <a-asset-item id="tesst4" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%BB%D1%8F%20%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82%D0%B0%2012%20final.obj"></a-asset-item>
        <a-asset-item id="tesst5" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%BB%D1%8F%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20name.obj"></a-asset-item>
    
          <a-asset-item id="tesst6" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2Flikvidation6.obj"></a-asset-item>
           <a-asset-item id="tesst7" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2Flikvidation8.obj"></a-asset-item>
    
         <a-asset-item id="tesst8" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2Flikvidation9.obj"></a-asset-item>
    
    <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg">>

    <img id="poster" src="https://cdn.glitch.com/6f99ad31-73ac-4760-87fc-7a7af6f64830%2F%D0%BF%D0%BB%D0%B0%D0%BA%D0%B0%D1%82%20stirlite%20Model%20final-01.jpg">
  </a-assets>
  

<!--<a-entity id="test3" scale="0.13 0.11 0.132" obj-model="obj: #MainModel; " position="-0.360 0.7 -0.86" material="color:white"></a-entity>-->
  

<a-marker  preset='hiro'>
 
  <a-entity id="test1" scale="0.037 0.02 0.04" obj-model="obj: #tesst1; " position="0.7 0.72 -0.20" material="color:black"></a-entity>
   
    <a-entity id="test2" scale="0.04 0.04 0.04" obj-model="obj: #tesst2; " position="-0.6 0.40 -0.6" material="color:black"></a-entity>
  
      <a-entity id="test3" scale="0.04 0.04 0.04" obj-model="obj: #tesst3; " position="0.30 0.43 0.15" material="color:black"></a-entity>
  
       <a-entity id="test4" scale="0.04 0.04 0.04" obj-model="obj: #tesst4; " position="0.25 0.41 -0.10" material="color:black"></a-entity>
  
         <a-entity id="test5" scale="0.04 0.04 0.04" obj-model="obj: #tesst5; " position="0.01 0.72 0.1" material="color:black"></a-entity>
    
      <!--<a-entity id="test6" scale="0.121 0.1 0.1" obj-model="obj: #tesst6; " position="-0.45 0.7 -0.50" material="color:black"></a-entity>
  
           <a-entity id="test7" scale="0.121 0.1 0.1" obj-model="obj: #tesst7; " position="-0.52 0.7 -0.43" material="color:black"></a-entity>
  
             <a-entity id="test8" scale="0.121 0.1 0.1" obj-model="obj: #tesst8; " position="-0.40 0.7 -0.42" material="color:black"></a-entity>-->
 
 <a-image id="test"   position="0 0.3 0" width="1" height="1.5" rotation='-90 0 0' material="color:white"></a-image>
    </a-marker>
  
<!--  <a-entity  id="posteR" src="#poster" position="0 0.5 0"  geometry="primitive: plane; height: 1.5; width: 1" rotation='-90 0 0'  material="color:black;  side: double;" ></a-entity>-->
  
 <a-entity camera></a-entity>
</a-scene>
     </div>
	  
 <script src="shared.js"></script>
      
<script>
var sample = new VisualizerSample();
document.querySelector('button').addEventListener('click', function() {
  sample.togglePlayback()
});
</script>
   </body>
</html>
